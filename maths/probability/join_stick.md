# 连接小棍

## 问题

将八根小棍握在手中，随机的将上端两两相连，下端两两相连，最后必然成为一个圈、两个圈、三个圈或四个圈，问各种情况出现的概率。

## 分析

排列数公式：

$$
P_n^m = \frac {n!} {(n-m)!}
$$

组合数公式：

$$
C_n^m = \frac {n!} {m!(n-m)!}
$$

将上端 $8$ 个端点连接起来的方法数：

$$
\begin{split}
\frac {C_8^2C_6^2C_4^2C_2^2} {P_4^4} &= \frac {8!} {2! \cdot 6!}
\cdot \frac {6!} {2! \cdot 4!}
\cdot \frac {4!} {2! \cdot 2!}
\cdot \frac {2!} {2! \cdot 0!}
\cdot \frac 1 {4!} \\
&= \frac {8!} {2! \cdot 2! \cdot 2! \cdot 2!} \\[1em]
&= 105
\end{split}
$$

因此所有的连法总共是 $105 \times 105 = 11025$ 种。

下面来计算各种情况出现的可能性。当上端已经选定一种连法后，实际上就成了四对小棍，可以在此基础上进一步思考。

一个圈，将四对小棍进行循环全排列，每两对小棍之间有 $2$ 种连法，因此总的连法为：

$$
105 \cdot \frac {P_4^4} 4 \cdot 2^3 = 5040
$$

两个圈分两种情况，第一种每个圈由 $4$ 个小棍组成；第二种每个圈分别由 $6$ 个和 $2$ 个小棍组成。

对于第一种，从四对小棍中选出两对相互连接，每选出一对都有 $2$ 种方法，剩下的两对相互连接，也有 $2$ 种方法，再排除掉重复情况，就是：

$$
\frac {105 \cdot C_4^2 \cdot 2 \cdot 2} {P_2^2} = 1260
$$

对于第二种，在上端已连好的情况下形成了四对小棍，从中选出三对相互连接，然后对这三对小棍进行循环全排列，于是有：

$$
105 \cdot C_4^3 \cdot \frac {P_3^3} 3 \cdot 2^2 = 3360
$$

三个圈，从四对小棍中选出两对，其上下端连法必须一致，另外两对小棍必须相互连接，方法有 $2$ 种，因此连法数为：

$$
105 \cdot C_4^2 \cdot 2 = 1260
$$

四个圈，上下端的连法必须一致，在上端已连好的情况下，下端只有一种连法，因此是 $105$ 种。

分别计算概率：

| 情形   | 概率                                   |
| ------ | -------------------------------------- |
| 一个圈 | $\frac {5040} {11025} = 45.7\%$        |
| 两个圈 | $\frac {1260 + 3360} {11025} = 41.9\%$ |
| 三个圈 | $\frac {1260} {11025} = 11.4\%$        |
| 四个圈 | $\frac {105} {11025} = 1.0\%$          |
